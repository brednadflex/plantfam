
<% if false %>
  
<div class="chatrooms-header">
  <div>
    <%= form_tag chat_rooms_path, method: :get do %>
      <div class="messages-searchbar">
       <%= text_field_tag :query,
        params[:query],
        class: "form-control",
        placeholder: "Find a message"
        %>
        <%= submit_tag "Search", class: "message-search-btn" %>
      </div>
    <% end %>
        <%= link_to users_path, class: "text-decoration-none text-reset" do  %>
          <div class="send-btn-float">
            <p>new</p>
            <i class="far fa-paper-plane"></i>
          </div>
        <% end %>
  </div>
</div>


<div class="chats-scrollbox">
  <% @chatrooms.each do |chatroom| %>
    <% if chatroom.messages.count > 0 %>
        <%= link_to chat_room_path(chatroom, anchor: "message-#{chatroom.messages.last.id}"), class: "text-decoration-none text-reset" do %>
          <div class="chatindex-list-container">
            <div class="header-avatar">
              <% other_person = current_user == chatroom.receiver ? chatroom.requester : chatroom.receiver  %>
              <%= image_tag other_person.profile.profile_img %>
            </div>
            <div class="name-and-date-flex">
              <div class="chatindex-otherperson-name">
                <h6><%= other_person.profile.first_name %> <%= other_person.profile.last_name %></h6>
                <div class = "msg-preview">
                  <p><%= chatroom.messages.last.content.first(30) %>...</p>
                </div>
              </div>
              <div class="chatindex-date-and-time">
               <small><%= chatroom.messages.last.created_at.strftime("%a %b %e at %l:%M%p") %></small>
              </div>
            </div>
          </div>
        <% end %>
    <% end %>
  <% end %>
</div>

<% end %>

<div class="main-wrapper">
  <div class="chat-header-flex-container">
    <h2 class="plant-fam-chat-header">PlantFam Chat</h2>
    <div class="chat-header-new-button">
      <p>New</p>
    </div>
  </div>
  <div class="chatroom-search-bar-flex-container">
    <%= image_tag "search.svg" %>
    <p>Search for a conversation</p>
  </div>
</div>

<div class="chats-scrollbox">
  <% @chatrooms.each do |chatroom| %>
    <% if chatroom.messages.count > 0 %>
      <%= link_to chat_room_path(chatroom, anchor: "message-#{chatroom.messages.last.id}"), class: "text-decoration-none text-reset" do %> 
        <div class="chat-with-other-user-flex-container">
          <div class="header-avatar">
            <% other_person = current_user == chatroom.receiver ? chatroom.requester : chatroom.receiver  %>
            <%= image_tag other_person.profile.profile_img %>
          </div>
          <div class="chat-container-right">
            <div class="chatindex-otherperson-name">
              <h6><%= other_person.profile.first_name %> <%= other_person.profile.last_name.first %>.</h6>
              <small class="chatindex-date-and-time"><%= chatroom.messages.last.created_at.strftime("%l:%M%p") %></small>
            </div>
            <div class = "msg-preview">
              <p><%= chatroom.messages.last.content.first(30) %>...</p>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  <% end %>
  <div class="bottom-nav-scroll-block"></div>
</div>


<% if false %>
  <small><%= chatroom.messages.last.created_at.strftime("%a %b %e at %l:%M%p") %></small>
<% end %>
